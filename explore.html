<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore Recipes - Maha Recipe Hub</title>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    background: #fffaf5;
    color: #333;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 30px;
    background: #fff;
    border-bottom: 1px solid #eee;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  header img {
    height: 50px;
    cursor: pointer;
    transition: transform 0.3s;
  }
  header img:hover { transform: scale(1.05); }

  nav {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  nav a {
    text-decoration: none;
    color: #333;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 6px;
    transition: all 0.3s;
  }
  nav a:hover { background: #ff7f50; color: #fff; }
  nav .login-btn { background: #ff7f50; color: #fff; }
  nav #logout-link { background: #ff4c4c; color: #fff; }

  .page-strip {
    background: linear-gradient(90deg, #ff7f50, #ffb07f);
    color: #fff;
    text-align: center;
    font-size: 2rem;
    font-weight: 700;
    padding: 20px 0;
  }

  main { flex: 1; padding: 20px 0; }

  .filters {
    margin: 20px auto;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
  }

  .filters button {
    padding: 8px 18px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    background: #fff4e6;
    color: #ff7f50;
    font-weight: 600;
    transition: all 0.3s;
  }
  .filters button:hover,
  .filters button.active {
    background: #ff7f50;
    color: #fff;
  }

  .recipe-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 25px;
    margin: 0 auto;
    max-width: 1200px;
  }

  .recipe-card {
    background: #fff;
    border-radius: 15px;
    overflow: hidden;
    width: 250px;
    cursor: pointer;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    transition: transform 0.3s, box-shadow 0.3s;
    text-align: center;
  }
  .recipe-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
  }
  .recipe-card img { width: 100%; height: 160px; object-fit: cover; }
  .recipe-card h3 { margin: 12px 0 8px 0; color: #ff7f50; font-size: 1.3rem; }
  .recipe-card p { padding: 0 12px 12px 12px; font-size: 0.95rem; color: #555; }

  footer {
    background: #333;
    color: white;
    padding: 30px 20px;
    text-align: center;
  }
  footer a { color: #ff7f50; margin: 0 10px; text-decoration: none; font-size: 1.2rem; }
  footer a:hover { color: #fff; }

</style>
</head>
<body>

<header>
  <img src="logo.png" alt="Maha Recipe Hub Logo" onclick="window.location.href='index.html'">
  <nav>
    <a href="index.html">Home</a>
    <a href="explore.html">Explore</a>
    <a href="recipe-generator.html">Find My Recipe</a>
    <a href="about.html">About</a>
    <a href="login.html" id="login-link" class="login-btn">Login</a>
    <span id="welcome-msg" style="display:none; font-weight:600;"></span>
    <a href="#" id="logout-link" style="display:none;">Logout</a>
  </nav>
</header>

<div class="page-strip">Explore Recipes</div>

<main>
  <div class="filters">
    <button data-category="all" class="active">All</button>
    <button data-category="breakfast">Breakfast</button>
    <button data-category="main">Main Course</button>
    <button data-category="snack">Snack</button>
    <button data-category="dessert">Dessert</button>
    <button data-category="beverages">Beverages</button>
  </div>

  <div id="status">Loading recipes...</div>
  <div class="recipe-container" id="recipe-list"></div>
</main>

<footer>
  <p>&copy; 2025 Maha Recipe Hub | All Rights Reserved</p>
</footer>

<script>
const SUPABASE_URL = "https://sraahdptzfbkrxrbllqx.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyYWFoZHB0emZia3J4cmJsbHF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1NDczMjMsImV4cCI6MjA3NDEyMzMyM30.lJ6E8E70Mag1F7VC9jT7JLZqhcOX7oJBX20BhBWjZy0";

const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

const loginLink = document.getElementById('login-link');
const logoutLink = document.getElementById('logout-link');
const welcomeMsg = document.getElementById('welcome-msg');

function checkLogin() {
  const user = localStorage.getItem('username');
  if(user) {
    loginLink.style.display = 'none';
    welcomeMsg.style.display = 'inline';
    welcomeMsg.textContent = `Welcome, ${user}`;
    logoutLink.style.display = 'inline';
  }
}
logoutLink.onclick = () => { localStorage.removeItem('username'); location.reload(); }
checkLogin();

const recipeList = document.getElementById("recipe-list");
const status = document.getElementById("status");
let recipes = [];

async function loadRecipes() {
  const { data, error } = await supabase.from('recipes').select('*');
  if(error) { status.textContent = "Failed to load recipes."; return; }

  recipes = data;
  status.style.display = "none";
  displayRecipes(recipes);
}

function displayRecipes(list) {
  recipeList.innerHTML = "";

  if(list.length === 0){
    recipeList.innerHTML = "<p>No recipes found.</p>";
    return;
  }

  list.forEach(recipe => {
    const card = document.createElement("div");
    card.className = "recipe-card";
    card.innerHTML = `
      <img src="${recipe.image_url}" alt="${recipe.name}">
      <h3>${recipe.name}</h3>
      <p>${recipe.description}</p>
    `;
    card.onclick = () => window.location.href = `recipe-detail.html?id=${recipe.id}`;
    recipeList.appendChild(card);
  });
}

document.querySelectorAll(".filters button").forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll(".filters button").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const cat = btn.dataset.category;
    displayRecipes(cat === "all" ? recipes : recipes.filter(r => r.category === cat));
  };
});

loadRecipes();
</script>

</body>
</html>
