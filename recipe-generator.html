<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recipe Generator - Maha Recipe Hub</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body { font-family: 'Inter', sans-serif; margin:0; background:#fff; color:#333; display:flex; flex-direction:column; min-height:100vh; }
header { display:flex; justify-content:space-between; align-items:center; padding:10px 30px; background:#fff; border-bottom:1px solid #eee; position:sticky; top:0; z-index:100; }
header img { height:50px; cursor:pointer; transition: transform 0.3s; }
header img:hover { transform: scale(1.05); }
nav { display:flex; align-items:center; gap:15px; }
nav a { text-decoration:none; color:#333; font-weight:600; padding:6px 14px; border-radius:6px; transition:all 0.3s; }
nav a:hover { background:#ff7f50; color:#fff; }
nav .login-btn { background:#ff7f50; color:#fff; }
nav #logout-link { background:#ff4c4c; color:#fff; }

.hero { background:linear-gradient(90deg,#ff7f50,#ffb07f); color:white; text-align:center; padding:60px 20px 40px 20px; }
.hero h1 { font-size:2.5rem; margin-bottom:20px; }
.hero p { font-size:1.2rem; max-width:800px; margin:0 auto 30px auto; line-height:1.6; }

main { flex:1; padding:40px 20px 20px 20px; text-align:center; }

.search-box { background:#fff; max-width:500px; margin:0 auto; padding:25px 20px; border-radius:15px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
.search-box input { width:90%; max-width:400px; padding:12px; border-radius:8px; border:1px solid #ddd; font-size:1rem; margin-bottom:20px; }
.search-box button { padding:12px 30px; background:orange; color:white; border:none; border-radius:8px; cursor:pointer; font-size:1rem; transition:background 0.3s; }
.search-box button:hover { background:darkorange; }

.filter-container { margin-top:20px; display:flex; justify-content:center; flex-wrap:wrap; gap:10px; }
.filter-container button { padding:6px 14px; border:none; border-radius:12px; background:#eee; cursor:pointer; font-weight:600; transition:0.3s; }
.filter-container button.active, .filter-container button:hover { background:#ff7f50; color:white; }

.recipe-container { display:flex; flex-wrap:wrap; justify-content:center; gap:25px; margin-top:30px; opacity:0; transition:opacity 0.6s ease-in-out; }
.recipe-container.visible { opacity:1; }

.recipe-card { background:#fff; border-radius:15px; overflow:hidden; width:250px; cursor:pointer; box-shadow:0 3px 8px rgba(0,0,0,0.1); transition:transform 0.3s, box-shadow 0.3s; text-align:center; animation:fadeInUp 0.6s ease-in-out; }
.recipe-card:hover { transform:translateY(-8px) scale(1.02); box-shadow:0 10px 20px rgba(0,0,0,0.15); }
.recipe-card img { width:100%; height:160px; object-fit:cover; }
.recipe-info { padding:12px; }
.recipe-info h3 { margin:0 0 6px 0; color:#ff7f50; font-size:1.3rem; }
.recipe-info p { font-size:0.9rem; color:#555; margin-bottom:6px; }
.recipe-info .badge { display:inline-block; padding:4px 8px; background:#ff7f50; color:#fff; font-size:0.75rem; border-radius:12px; }

.loader { text-align:center; margin-top:40px; color:#ff7f50; }
.loader i { font-size:2rem; animation:spin 1s linear infinite; }

.no-results { text-align:center; color:#666; font-size:1.2rem; margin-top:30px; }

footer { background:#333; color:white; padding:30px 20px; text-align:center; }
footer a { color:#ff7f50; margin:0 10px; text-decoration:none; font-size:1.2rem; }
footer a:hover { color:#fff; }

@keyframes spin { from { transform:rotate(0deg);} to { transform:rotate(360deg); } }
@keyframes fadeInUp { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }

@media (max-width:600px) { .recipe-card{width:90%;} .search-box{width:90%; padding:20px;} header{flex-direction:column; gap:12px;} }
</style>
</head>
<body>

<header>
  <img src="logo.png" alt="Maha Recipe Hub Logo" onclick="window.location.href='index.html'">
  <nav>
    <a href="index.html">Home</a>
    <a href="explore.html">Explore</a>
    <a href="recipe-generator.html" style="background:#ff7f50;color:#fff;">Find My Recipe</a>
    <a href="about.html">About</a>
    <a href="login.html" id="login-link" class="login-btn">Login</a>
    <span id="welcome-msg" style="display:none; font-weight:600;"></span>
    <a href="#" id="logout-link" style="display:none;">Logout</a>
  </nav>
</header>

<div class="hero">
  <h1>FIND YOUR RECIPE HERE</h1>
  <p>Discover recipes by entering the ingredients you have. Find Maharashtrian delights or any dish you love, instantly!</p>
</div>

<main>
  <div class="search-box">
    <input type="text" id="ingredientInput" placeholder="Enter ingredients (comma separated)">
    <br>
    <button id="searchBtn">Search For Recipe</button>
  </div>

  <!-- Filters -->
  <div class="filter-container" id="filterContainer" style="display:none;">
    <button data-type="all" class="active">All</button>
    <button data-type="veg">Veg</button>
    <button data-type="non-veg">Non-Veg</button>
    <button data-type="breakfast">Breakfast</button>
    <button data-type="main course">Main Course</button>
    <button data-type="snacks">Snacks</button>
    <button data-type="desserts">Desserts</button>
    <button data-type="beverages">Beverages</button>
  </div>

  <div class="recipe-container" id="recipeResults"></div>
</main>

<footer>
  &copy; 2025 Maha Recipe Hub | All Rights Reserved
  <div class="footer-social">
    <a href="https://facebook.com"><i class="fab fa-facebook-f"></i></a>
    <a href="https://instagram.com"><i class="fab fa-instagram"></i></a>
    <a href="https://youtube.com"><i class="fab fa-youtube"></i></a>
  </div>
</footer>

<script>
// Login/Logout
const loginLink = document.getElementById('login-link');
const logoutLink = document.getElementById('logout-link');
const welcomeMsg = document.getElementById('welcome-msg');
function checkLogin() {
  const user = localStorage.getItem('username');
  if(user) { loginLink.style.display='none'; welcomeMsg.style.display='inline'; welcomeMsg.textContent=`Welcome, ${user}`; logoutLink.style.display='inline'; }
  else { loginLink.style.display='inline'; welcomeMsg.style.display='none'; logoutLink.style.display='none'; }
}
logoutLink.addEventListener('click', ()=>{ localStorage.removeItem('username'); checkLogin(); });
checkLogin();

// Recipe search
const container = document.getElementById("recipeResults");
const btn = document.getElementById("searchBtn");
const input = document.getElementById("ingredientInput");
const filterContainer = document.getElementById("filterContainer");

let currentRecipes = [];

async function searchRecipes() {
  const query = input.value.trim();
  container.innerHTML = "";
  container.classList.remove("visible");
  filterContainer.style.display = "none";

  if(!query) { container.innerHTML="<div class='no-results'>Please enter ingredients.</div>"; container.classList.add("visible"); return; }

  container.innerHTML="<div class='loader'><i class='fas fa-spinner'></i></div>";
  container.classList.add("visible");

  try {
    const res = await fetch(`http://localhost:3000/api/search?q=${encodeURIComponent(query)}`);
    const data = await res.json();

    setTimeout(() => {
      container.innerHTML = "";
      if(!data || data.length===0) { 
        container.innerHTML=`<div class='no-results'>üç¥ No recipes found for "<b>${query}</b>"</div>`; 
      } else {
        currentRecipes = data;
        filterContainer.style.display = "flex";
        renderRecipes(currentRecipes);
      }
      container.classList.add("visible");
    },400);
  } catch(err) {
    console.error(err);
    container.innerHTML="<div class='no-results'>‚ö†Ô∏è Error fetching recipes. Please try again later.</div>";
    container.classList.add("visible");
  }
}

function renderRecipes(recipes) {
  container.innerHTML = "";
  recipes.forEach(r => {
    const card = document.createElement("div");
    card.className = "recipe-card";
    card.innerHTML = `
      <img src="${r.image_url}" alt="${r.name}">
      <div class="recipe-info">
        <h3>${r.name}</h3>
        <p>${r.description ? r.description.substring(0,80)+"..." : ""}</p>
        <span class="badge">${r.category || 'Uncategorized'}</span>
      </div>
    `;
    card.addEventListener("click", ()=>{ window.location.href=`recipe-detail.html?id=${r.id}`; });
    container.appendChild(card);
  });
}

// Filters
const filterBtns = filterContainer.querySelectorAll("button");
filterBtns.forEach(btn=>{
  btn.addEventListener("click", ()=>{
    filterBtns.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    const type = btn.dataset.type;
    const filtered = type==='all' ? currentRecipes : currentRecipes.filter(r=>r.category && r.category.toLowerCase()===type.toLowerCase());
    renderRecipes(filtered);
  });
});

btn.addEventListener("click", searchRecipes);
input.addEventListener("keypress", e=>{ if(e.key==="Enter") searchRecipes(); });
</script>

</body>
</html>
