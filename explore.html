<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore Recipes - Maha Recipe Hub</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    background: #fffaf5;
    color: #333;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 30px;
    background: #fff;
    border-bottom: 1px solid #eee;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  header img {
    height: 50px;
    cursor: pointer;
    transition: transform 0.3s;
  }
  header img:hover { transform: scale(1.05); }

  nav {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  nav a {
    text-decoration: none;
    color: #333;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 6px;
    transition: all 0.3s;
  }
  nav a:hover { background: #ff7f50; color: #fff; }
  nav .login-btn { background: #ff7f50; color: #fff; }
  nav #logout-link { background: #ff4c4c; color: #fff; }

  /* Orange strip for page title */
  .page-strip {
    background: linear-gradient(90deg, #ff7f50, #ffb07f);
    color: #fff;
    text-align: center;
    font-size: 2rem;
    font-weight: 700;
    padding: 20px 0;
  }

  main {
    flex: 1;
    padding: 20px 0;
  }

  .filters {
    margin: 20px auto;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
  }
  .filters button {
    padding: 8px 18px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    background: #fff4e6;
    color: #ff7f50;
    font-weight: 600;
    transition: all 0.3s;
  }
  .filters button:hover,
  .filters button.active {
    background: #ff7f50;
    color: #fff;
  }

  /* Dropdown filter */
  .dropdown {
    position: relative;
    display: inline-block;
  }
  .dropbtn {
    padding: 8px 18px;
    border-radius: 20px;
    border: none;
    cursor: pointer;
    background: #fff4e6;
    color: #ff7f50;
    font-weight: 600;
  }
  .dropdown-content {
    display: none;
    position: absolute;
    background: #fff4e6;
    min-width: 120px;
    box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
    border-radius: 10px;
    z-index: 1;
  }
  .dropdown-content button {
    display: block;
    width: 100%;
    border: none;
    background: none;
    padding: 8px;
    text-align: left;
    cursor: pointer;
    font-weight: 600;
    color: #ff7f50;
  }
  .dropdown-content button:hover {
    background: #ff7f50;
    color: #fff;
  }
  .dropdown:hover .dropdown-content { display: block; }

  .recipe-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 25px;
    margin: 0 auto;
    max-width: 1200px;
  }

  .recipe-card {
    background: #fff;
    border-radius: 15px;
    overflow: hidden;
    width: 250px;
    cursor: pointer;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    transition: transform 0.3s, box-shadow 0.3s;
    text-align: center;
  }
  .recipe-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
  }
  .recipe-card img { width: 100%; height: 160px; object-fit: cover; }
  .recipe-card h3 { margin: 12px 0 8px 0; color: #ff7f50; font-size: 1.3rem; }
  .recipe-card p { padding: 0 12px 12px 12px; font-size: 0.95rem; color: #555; }

  footer {
    background: #333;
    color: white;
    padding: 30px 20px;
    text-align: center;
  }
  footer a { color: #ff7f50; margin: 0 10px; text-decoration: none; font-size: 1.2rem; }
  footer a:hover { color: #fff; }

  @media (max-width: 600px) {
    .recipe-card { width: 90%; }
    .filters { flex-direction: column; gap: 8px; }
    header { flex-direction: column; gap: 12px; }
  }
</style>
</head>
<body>

<header>
  <img src="logo.png" alt="Maha Recipe Hub Logo" onclick="window.location.href='index.html'">
  <nav>
    <a href="index.html">Home</a>
    <a href="explore.html">Explore</a>
    <a href="recipe-generator.html">Find My Recipe</a>
    <a href="about.html">About</a>
    <a href="login.html" id="login-link" class="login-btn">Login</a>
    <span id="welcome-msg" style="display:none; font-weight:600;"></span>
    <a href="#" id="logout-link" style="display:none;">Logout</a>
  </nav>
</header>

<!-- Orange strip for page title -->
<div class="page-strip">Explore Recipes</div>

<main>
  <!-- Filters -->
  <div class="filters">
    <button data-category="all" class="active">All</button>
    <button data-category="breakfast">Breakfast</button>
    <button data-category="main">Main Course</button>
    <button data-category="snack">Snack</button>
    <button data-category="dessert">Dessert</button>
    <button data-category="beverages">Beverages</button>

    <!-- Dropdown for Type Filter -->
    <div class="dropdown">
      <button class="dropbtn">Type</button>
      <div class="dropdown-content">
        <button data-type="veg">Veg</button>
        <button data-type="nonveg">Non-Veg</button>
      </div>
    </div>
  </div>

  <div id="status" class="loading">Loading recipes...</div>
  <div class="recipe-container" id="recipe-list"></div>
</main>

<footer>
  <p>&copy; 2025 Maha Recipe Hub | All Rights Reserved</p>
  <p>Contact us: <a href="mailto:info@maharecipehub.com">info@maharecipehub.com</a></p>
  <div class="footer-social">
    <a href="https://facebook.com"><i class="fab fa-facebook-f"></i></a>
    <a href="https://instagram.com"><i class="fab fa-instagram"></i></a>
    <a href="https://youtube.com"><i class="fab fa-youtube"></i></a>
  </div>
</footer>

<script>
const loginLink = document.getElementById('login-link');
const logoutLink = document.getElementById('logout-link');
const welcomeMsg = document.getElementById('welcome-msg');

function checkLogin() {
  const user = localStorage.getItem('username');
  if(user) {
    loginLink.style.display = 'none';
    welcomeMsg.style.display = 'inline';
    welcomeMsg.textContent = `Welcome, ${user}`;
    logoutLink.style.display = 'inline';
  } else {
    loginLink.style.display = 'inline';
    welcomeMsg.style.display = 'none';
    logoutLink.style.display = 'none';
  }
}
logoutLink.addEventListener('click', () => {
  localStorage.removeItem('username');
  checkLogin();
});
checkLogin();

const recipeList = document.getElementById("recipe-list");
const status = document.getElementById("status");
let recipes = [];
let typeFilter = null;

// Fetch recipes
fetch("/api/recipes")
  .then(res => res.json())
  .then(data => {
    recipes = data;
    status.style.display = "none";
    displayRecipes(recipes);
  })
  .catch(err => {
    status.textContent = "Failed to load recipes.";
    console.error(err);
  });

function displayRecipes(list) {
  recipeList.innerHTML = "";
  let filtered = list;

  if(typeFilter) {
    filtered = filtered.filter(r => r.type && r.type.toLowerCase() === typeFilter);
  }

  if(filtered.length === 0){
    recipeList.innerHTML = "<p>No recipes found.</p>";
    return;
  }

  filtered.forEach(recipe => {
    const card = document.createElement("div");
    card.className = "recipe-card";
    card.innerHTML = `
      <img src="${recipe.image_url || 'images/placeholder.png'}" alt="${recipe.name}">
      <h3>${recipe.name}</h3>
      <p>${recipe.description || "No description available."}</p>
    `;
    card.addEventListener("click", () => {
      window.location.href = `recipe-detail.html?id=${recipe.id}`;
    });
    recipeList.appendChild(card);
  });
}

// Category filter
document.querySelectorAll(".filters button[data-category]").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".filters button[data-category]").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const cat = btn.dataset.category;
    const catFiltered = cat === "all" ? recipes : recipes.filter(r => r.category === cat);
    displayRecipes(catFiltered);
  });
});

// Type filter from dropdown
document.querySelectorAll(".dropdown-content button").forEach(btn => {
  btn.addEventListener("click", () => {
    typeFilter = btn.dataset.type;
    displayRecipes(recipes);
  });
});
</script>

</body>
</html>

